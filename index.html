<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>r/IndianRailways Growth Tracker</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns"></script>
<style>
  body {
    background-color: #0e0e10;
    color: #fff;
    font-family: 'Inter', sans-serif;
    margin: 0;
    padding: 0;
  }
  .container {
    max-width: 1000px;
    margin: 0 auto;
    padding: 24px;
  }
  .header {
    text-align: center;
    margin-bottom: 20px;
  }
  .header h1 {
    font-size: 28px;
    font-weight: 600;
    margin-bottom: 8px;
  }
  .stats {
    display: flex;
    justify-content: space-around;
    margin-bottom: 20px;
    flex-wrap: wrap;
  }
  .stat {
    background: rgba(255,255,255,0.05);
    border-radius: 12px;
    padding: 12px 20px;
    text-align: center;
    margin: 8px;
    flex: 1;
    min-width: 180px;
  }
  .stat .value {
    font-size: 22px;
    font-weight: 600;
  }
  .stat .label {
    font-size: 14px;
    color: #aaa;
  }
  canvas {
    width: 100%;
    height: 400px;
  }
  .range-buttons {
    text-align: center;
    margin-top: 16px;
  }
  .range-buttons button {
    background: rgba(255,255,255,0.1);
    color: white;
    border: none;
    margin: 0 4px;
    padding: 8px 14px;
    border-radius: 6px;
    cursor: pointer;
  }
  .range-buttons button.active {
    background: #4CAF50;
  }
</style>
</head>
<body>
<div class="container">
  <div class="header">
    <h1>r/IndianRailways Growth Tracker</h1>
    <p>Visualizing subreddit growth over time</p>
  </div>

  <div class="stats">
    <div class="stat">
      <div class="value" id="count">Loading...</div>
      <div class="label">Current Members</div>
    </div>
    <div class="stat">
      <div class="value" id="growth-today">+0</div>
      <div class="label">Last 24 Hours</div>
    </div>
    <div class="stat">
      <div class="value" id="growth-week">+0</div>
      <div class="label">Last 7 Days</div>
    </div>
    <div class="stat">
      <div class="value" id="growth-month">+0</div>
      <div class="label">Last 30 Days</div>
    </div>
    <div class="stat">
      <div class="value" id="growth-year">+0</div>
      <div class="label">Last 12 Months</div>
    </div>
  </div>

  <canvas id="growthChart"></canvas>

  <div class="range-buttons">
    <button data-range="24h" class="active">24 Hours</button>
    <button data-range="7d">7 Days</button>
    <button data-range="30d">30 Days</button>
    <button data-range="12m">12 Months</button>
  </div>
</div>

<script>
const DAY_MS = 24 * 60 * 60 * 1000;

// Example seed data
const GROWTH_TODAY = 250;
const GROWTH_WEEK = 1800;
const GROWTH_MONTH = 5600;
const GROWTH_YEAR = 105000;
const CURRENT_COUNT = 1190000; // example member count

document.getElementById('count').innerText = CURRENT_COUNT.toLocaleString('en-IN');
document.getElementById('growth-today').innerText = '+' + GROWTH_TODAY.toLocaleString('en-IN');
document.getElementById('growth-week').innerText = '+' + GROWTH_WEEK.toLocaleString('en-IN');
document.getElementById('growth-month').innerText = '+' + GROWTH_MONTH.toLocaleString('en-IN');
document.getElementById('growth-year').innerText = '+' + GROWTH_YEAR.toLocaleString('en-IN');

let currentRange = '24h';
let chart;

// Generate smooth data over a range
function generateData(range) {
  const now = Date.now();
  let points = [];
  let steps, interval, totalGrowth;

  switch(range) {
    case '24h':
      steps = 24;
      interval = DAY_MS / 24;
      totalGrowth = GROWTH_TODAY;
      break;
    case '7d':
      steps = 7;
      interval = DAY_MS;
      totalGrowth = GROWTH_WEEK;
      break;
    case '30d':
      steps = 30;
      interval = DAY_MS;
      totalGrowth = GROWTH_MONTH;
      break;
    case '12m':
      steps = 12;
      interval = 30 * DAY_MS;
      totalGrowth = GROWTH_YEAR;
      break;
  }

  const startCount = CURRENT_COUNT - totalGrowth;
  for (let i = 0; i <= steps; i++) {
    const progress = i / steps;
    const randomFactor = 1 + (Math.random() - 0.5) * 0.05; // Â±5% randomness
    const count = startCount + totalGrowth * Math.pow(progress, 1.5) * randomFactor;
    points.push({ x: now - (steps - i) * interval, y: count });
  }
  return points;
}

function formatNumberIndian(x) {
  return x.toLocaleString('en-IN');
}

function renderChart() {
  const ctx = document.getElementById('growthChart').getContext('2d');
  const ranges = {
    '24h': { unit: 'hour' },
    '7d': { unit: 'day' },
    '30d': { unit: 'day' },
    '12m': { unit: 'month' }
  };

  const data = generateData(currentRange);
  const { unit } = ranges[currentRange];
  if (chart) chart.destroy();

  chart = new Chart(ctx, {
    type: 'line',
    data: {
      datasets: [{
        data: data,
        borderColor: '#4CAF50',
        borderWidth: 2,
        pointRadius: 0,
        tension: 0.25,
      }],
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      animation: false,
      scales: {
        x: {
          type: 'time',
          time: {
            unit,
            displayFormats: {
              hour: 'ha',
              day: 'MMM d',
              month: 'MMM yyyy',
            },
          },
          ticks: {
            color: '#aaa',
            autoSkip: true,
            maxTicksLimit: currentRange === '12m' ? 6 :
                           currentRange === '30d' ? 10 :
                           currentRange === '7d' ? 7 : 12,
          },
          grid: { color: 'rgba(255,255,255,0.05)' },
        },
        y: {
          ticks: { color: '#aaa', callback: v => formatNumberIndian(v) },
          grid: { color: 'rgba(255,255,255,0.05)' },
        },
      },
      plugins: {
        legend: { display: false },
        tooltip: {
          callbacks: {
            title: items => new Date(items[0].parsed.x)
              .toLocaleDateString('en-IN', { day: 'numeric', month: 'short', year: 'numeric' }),
            label: item => `Count: ${formatNumberIndian(item.parsed.y)}`,
          },
        },
      },
    },
  });
}

document.querySelectorAll('.range-buttons button').forEach(btn => {
  btn.addEventListener('click', () => {
    document.querySelectorAll('.range-buttons button').forEach(b => b.classList.remove('active'));
    btn.classList.add('active');
    currentRange = btn.dataset.range;
    renderChart();
  });
});

renderChart();
</script>
</body>
</html>
